CC = gcc
CXX = g++
CFLAGS = -O2 -Wall -g #-DDEBUG #-DUSE_HISTORY
CCLINK = gcc 
XINCLUDE = /usr/X11R6/include
XLIB = -L/usr/X11R6/lib -lX11 -lXext
FLLIB = -L/usr/local/lib -lfltk
DESTDIR = /usr/local/
MANDIR = man/man1

RM = rm -f
INSTALL = install -c
INSTMANFLAGS = -m 644
MKDIRHIER = mkdirhier
YACC = bison -y
TAGS = etags

vpath %.H ./fl_ag_file_chooser
vpath %.cxx ./fl_ag_file_chooser

# Shouldn't need to edit below here

SRCS = scstub.cpp cmds.c format.c gram.c graphing.c help.c interp.c \
     lex.c matrix.c plot.c scmain.c range.c screen.c scXstuff.c edit.c \
     vmtbl.c xmalloc.c

OBJS = scstub.o cmds.o format.o gram.o graphing.o help.o interp.o \
     lex.o matrix.o plot.o scmain.o range.o screen.o scXstuff.o edit.o \
     vmtbl.o xmalloc.o

FLOBJ = browser.o chooser.o

HDRS = config.h experres.h pattern.h plot.h sc.h \
     scXstuff.h statres.h y.tab.h version.h

all: xspread xsdata

xspread: $(OBJS) $(FLOBJ)
	$(RM) $@
	$(CCLINK) -o $@ $(OBJS) $(FLOBJ) $(XLIB) $(FLLIB) -lm -lstdc++

xsdata: xsdata.c 
	$(CC) -Wall -o $@ $<

install:: xspread xsdata
	@if [ -d $(DESTDIR)bin ]; then set +x; \
	else (set -x; $(MKDIRHIER) $(DESTDIR)bin); fi
	$(INSTALL) xspread $(DESTDIR)bin/xspread
	$(INSTALL) xsdata $(DESTDIR)bin/xsdata

install.man:: 
	@if [ -d $(DESTDIR)$(MANDIR) ]; then set +x; \
	else (set -x; $(MKDIRHIER) $(DESTDIR)$(MANDIR)); fi
	$(INSTALL) $(INSTMANFLAGS) man/xspread.man $(DESTDIR)$(MANDIR)/xspread.1
	$(INSTALL) $(INSTMANFLAGS) man/xsdata.man $(DESTDIR)$(MANDIR)/xsdata.1

depend::
	makedepend -Y $(SRCS)

.c.o:
	$(CC) ${CFLAGS} -c $<

scstub.o: scstub.cpp
	$(CXX) ${CFLAGS} -I./fl_ag_file_chooser -c $<

browser.o: Fl_Ag_Browser_.cxx
	$(CXX) $(FLINCLUDE) -c -o browser.o $<

chooser.o: fl_ag_file_chooser.cxx
	$(CXX) $(FLINCLUDE) -c -o chooser.o $<

experres.h: eres.sed gram.y
	sed < gram.y > $@ -f $<

statres.h: sres.sed gram.y
	sed < gram.y > $@ -f $<

gram.c y.tab.h: gram.y
	$(YACC) -d $< ; mv y.tab.c gram.c

gram.o: gram.c sc.h y.tab.h
	$(CC) ${CFLAGS} -c $<

.PHONY : test vr3

test: 
	cd test && make

vr3:
	cd vr3 && make

# ----------------------------------------------------------------------
# common rules for all Makefiles - do not edit

emptyrule::

clean::
	$(RM) *.o core xspread xsdata

tags::
	$(TAGS) *.[ch] *.cpp

# ----------------------------------------------------------------------
# empty rules for directories that do not have SUBDIRS - do not edit

install::
	@echo "install done"

install.man::
	@echo "install.man done"

Makefiles::

includes::

depend::

# ----------------------------------------------------------------------
# dependencies generated by makedepend

# DO NOT DELETE

cmds.o: config.h sc.h scXstuff.h plot.h
format.o: config.h sc.h
gram.o: sc.h config.h
graphing.o: config.h sc.h scXstuff.h plot.h
help.o: config.h sc.h scXstuff.h
interp.o: config.h sc.h scXstuff.h
lex.o: config.h sc.h scXstuff.h y.tab.h experres.h statres.h
matrix.o: config.h sc.h
plot.o: plot.h config.h sc.h scXstuff.h pattern.h
scmain.o: config.h sc.h scXstuff.h plot.h version.h
range.o: config.h scXstuff.h sc.h
screen.o: config.h sc.h scXstuff.h
scXstuff.o: sc.h config.h
edit.o: config.h sc.h scXstuff.h
vmtbl.o: config.h sc.h
xmalloc.o: config.h sc.h
