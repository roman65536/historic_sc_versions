CC = mipsel-linux-gcc -B/opt/snow-gcc/lib/snow/ -fno-pic -msoft-float
CXX = mipsel-linux-g++ -B/opt/snow-gcc/lib/snow/ -fno-pic -msoft-float
XINCLUDE = /usr/X11R6/include
CFLAGS = -Wall -Os 
DEFINES = -DVR3 
INCLUDES = -I.. -I$(XINCLUDE)
XLIB = -lX11 -lXext -lXpm
FLINCLUDE = -I/usr/local/include
FLLIB = -lfltk
BINPATH = agenda::root/usr/local/bin
ICONPATH = agenda::root/usr/local/pixmaps

RM = rm -f
YACC = bison -y
TAGS = etags

vpath %.c ..
vpath %.h ..
vpath %.y ..
vpath %.sed ..
vpath %.cpp ..
vpath %.H ../fl_ag_file_chooser
vpath %.cxx ../fl_ag_file_chooser

# Shouldn't need to edit below here

SRCS = scstub.cpp cmds.c format.c gram.c graphing.c small_help.c interp.c \
     lex.c matrix.c plot.c scmain.c range.c screen.c scXstuff.c edit.c \
     vmtbl.c xmalloc.c

OBJS = scstub.o cmds.o format.o gram.o graphing.o small_help.o interp.o \
     lex.o matrix.o plot.o scmain.o range.o screen.o scXstuff.o edit.o \
     vmtbl.o xmalloc.o

FLOBJ = browser.o chooser.o

HDRS = config.h experres.h pattern.h plot.h sc.h scXstuff.h \
	statres.h y.tab.h version.h

PROG = xspread

all: $(PROG)

$(PROG): $(OBJS) $(FLOBJ)
	$(RM) $@
	$(CC) -o $@ $(OBJS) $(FLOBJ) $(XLIB) $(FLLIB) -lm -lstdc++
	./strip.sh $(PROG)

install:: $(PROG)
	rsync $(PROG) $(BINPATH)

install.icon::
	rsync xfm_sc.xpm $(ICONPATH)

.c.o:
	$(CC) ${CFLAGS} ${DEFINES} ${INCLUDES} -c $<

scstub.o: scstub.cpp
	$(CXX) ${CFLAGS} $(FLINCLUDE) -I../fl_ag_file_chooser -c $<

browser.o: Fl_Ag_Browser_.cxx
	$(CXX) ${CFLAGS} ${DEFINES} $(FLINCLUDE) -c -o browser.o $<

chooser.o: fl_ag_file_chooser.cxx
	$(CXX) ${CFLAGS} ${DEFINES} $(FLINCLUDE) -c -o chooser.o $<

experres.h: eres.sed
	sed < gram.y > $@ -f $<

statres.h: sres.sed
	sed < gram.y > $@ -f $<

gram.c: gram.y
	$(YACC) -d $< ; mv y.tab.c $@

gram.o: gram.c sc.h y.tab.h
	$(CC) ${CFLAGS} ${DEFINES} ${INCLUDES} -c $<

depend: 
	makedepend -Y -- $(DEFINES) -- ../*.c ../*.h ../*.cpp && \
	sed s+^'../'++ < Makefile > Makefile.tmp && \
	mv Makefile.tmp Makefile

# ----------------------------------------------------------------------
# common rules for all Makefiles - do not edit

emptyrule::

clean::
	$(RM) *.o core xspread

# dependencies generated by makedepend

# DO NOT DELETE

cmds.o: ../config.h ../sc.h ../scXstuff.h ../plot.h
edit.o: ../config.h ../sc.h ../scXstuff.h
format.o: ../config.h ../sc.h
gram.o: ../sc.h ../config.h
graphing.o: ../config.h ../sc.h ../scXstuff.h ../plot.h
help.o: ../config.h ../sc.h ../scXstuff.h
interp.o: ../config.h ../sc.h ../scXstuff.h
lex.o: ../config.h ../sc.h ../scXstuff.h ../y.tab.h ../experres.h
lex.o: ../statres.h
matrix.o: ../config.h ../sc.h
plot.o: ../plot.h ../config.h ../sc.h ../scXstuff.h
plot.o: ../pixmaps/fivebyseven.xpm
range.o: ../config.h ../scXstuff.h ../sc.h
scXstuff.o: ../sc.h ../config.h
scmain.o: ../config.h ../sc.h ../scXstuff.h ../plot.h ../version.h
screen.o: ../config.h ../sc.h ../scXstuff.h
small_help.o: ../config.h ../sc.h ../scXstuff.h
vmtbl.o: ../config.h ../sc.h
xmalloc.o: ../config.h ../sc.h
xsdata.o: ../config.h ../sc.h
plot.o: ../config.h ../sc.h ../scXstuff.h
sc.o: ../config.h
